#!/bin/bash

# Author : Hussien Misbah
# requirements : searchsploit,wget installed
# must provide at least one input
# download all exploits at exploit db .
# sleep is to avoid getting blocked from the website

figlet "Grep Exploits"
echo -e "\n\n"
if [ $# == 0 ]
then


	echo 'usage ./grep_expoits.sh <arg1>'
	echo "example : ./grep_exploits.sh 'laravel'"

else
	exp=$1
        echo -e  "[+] searching and downloading  $exp  exploits . . . \n\n "

	if  [ $(searchsploit $exp | head -1 | cut -d ' ' -f 2 ) == "No"  ]
	then
		echo "[+] no exploits found :( "
	else
		mkdir "$exp exploits"
		cd    "$exp exploits"
    		for exploit in $( searchsploit $exp -w  | grep "http" | cut -d "|" -f 2 | sed s/exploits/raw/g | tr -d " " )

			do

			wget $exploit -q
			echo -n "#"
			sleep 3
			done

		echo -e "\n\n[+] done :D"
	fi
fi
